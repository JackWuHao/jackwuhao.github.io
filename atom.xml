<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://jackwuhao.github.io</id>
    <title>吴浩的个人博客</title>
    <updated>2019-11-26T14:01:10.202Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://jackwuhao.github.io"/>
    <link rel="self" href="https://jackwuhao.github.io/atom.xml"/>
    <subtitle>每一天都是学习的一天</subtitle>
    <logo>https://jackwuhao.github.io/images/avatar.png</logo>
    <icon>https://jackwuhao.github.io/favicon.ico</icon>
    <rights>All rights reserved 2019, 吴浩的个人博客</rights>
    <entry>
        <title type="html"><![CDATA[django 添加日志管理]]></title>
        <id>https://jackwuhao.github.io/post/django-tian-jia-ri-zhi-guan-li</id>
        <link href="https://jackwuhao.github.io/post/django-tian-jia-ri-zhi-guan-li">
        </link>
        <updated>2019-11-26T13:58:04.000Z</updated>
        <content type="html"><![CDATA[<p>在admin.py 中添加一下代码</p>
<pre><code>from django.contrib.admin.models import LogEntry

@admin.register(LogEntry,site=customer_site)
class LogEntryAdmin(admin.ModelAdmin):
    list_display = ['object_repr','object_id','action_flag','user','change_message']
</code></pre>
<p>重新运行一遍就有了</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[django完整的项目开发配置]]></title>
        <id>https://jackwuhao.github.io/post/django-wan-zheng-de-xiang-mu-kai-fa-pei-zhi</id>
        <link href="https://jackwuhao.github.io/post/django-wan-zheng-de-xiang-mu-kai-fa-pei-zhi">
        </link>
        <updated>2019-11-23T03:23:30.000Z</updated>
        <content type="html"><![CDATA[<h1 id="开始本篇教程之前你需要了解的内容">开始本篇教程之前你需要了解的内容</h1>
<p>1  <strong>基础知识: python的基础知识,django基础命令,git基础 mysql</strong><br>
2  <strong>开发工具:pycahrm  ,python3.6 ,django2.2以上 ,mysql（非必须,navicate(非必须)</strong></p>
<h1 id="创建项目和app">创建项目和APP</h1>
<p>1 <strong>打开pycharm 创建一个django项目</strong></p>
<pre><code>//在终端创建一个名为student的app
 python manager.py  startapp student
</code></pre>
<p><strong>此时的项目目录为</strong><br>
<img src="https://jackwuhao.github.io/post-images/1574480195551.png" alt=""></p>
<h1 id="修改项目配置">修改项目配置</h1>
<p><strong>settings.py介绍:这是我们django项目的配置文件，基本上我们项目的所有配置都需要在这个文件下完成</strong>
1 <strong>修改时区的设置:默认时间设置不是中国时间，这样你在网数据库存时间的时候会发现，数据全是英文时间也对不上</strong></p>
<pre><code># 把settings上面的默认字段修改为
LANGUAGE_CODE = 'zh-hans'   #语言中文
TIME_ZONE = 'Asia/Shanghai'   # 上海时间 （别问我为啥是上海,不是北京问就是没有）
USE_TZ = False    #把本地时间禁止,不要考虑本地时间的存在
</code></pre>
<p>2 <strong>数据库的设置</strong>
1 如果你的项目是小项目那完全没必要修改了sqlite完全够用了
2 企业或者有性能要求的：
<strong>修改数据库的默认配置</strong></p>
<pre><code>//打开终端下载pymysql (当然他的也行这里以pymysql 举例了)
pip install pymysql
</code></pre>
<p><strong>修改之前有两个坑（在你python manager   和  python  manager   migrate 会出现）</strong>
第一个问题: raise ImproperlyConfigured('mysqlclient 1.3.13 or newer is required; you have %s.' % Database.<strong>version</strong>) 　　　django.core.exceptions.ImproperlyConfigured: mysqlclient 1.3.13 or newer is required; you have 0.9.3.
<strong>结局方案</strong>
1.python安装目录打开base.py，注释掉以下内容： 　　　　　　　
if version &lt; (1, 3, 13):
　raise ImproperlyConfigured('mysqlclient 1.3.13 or newer is required; you have %s.' % Database.<strong>version</strong>)</p>
<p>2.query = query.decode(errors='replace') 　
把报错decode修改为encode
<strong>提前创建好数据库</strong>
建议安装mysql的时候顺便安装一下navicate ,可视化操作方便多了你要是喜欢敲命令当我没说
如何安装mysql我这里就不讲了，自行goole或者百度
<strong>引入pymysql</strong>
在settings.py中添加以下代码</p>
<pre><code>#要引入pymysql必须引入加入这两句代码
import pymysql
pymysql.install_as_MySQLdb()
#修改配置文件 
DATABASES = {
    # 'default': {
    #     'ENGINE': 'django.db.backends.sqlite3',
    #     'NAME': os.path.join(BASE_DIR, 'db.sqlite3'),
    # }
    'default': {
        'ENGINE': 'django.db.backends.mysql',  # 数据库引擎
        'NAME': '你创建的数据库的名称',  # 数据库名，先前创建的
        'USER': '你mysql的用户名',  # 用户名，可以自己创建用户
        'PASSWORD': '你mysql的密码',  # 密码
        'HOST': 'localhost',  # mysql服务所在的主机ip这里默认为本地127.0.0.1
        'PORT': '3306',  # mysql服务端口
				#测试的数据库，如果不写测试用例的话可以去掉
        'TEST': {
				#这里的数据库不用提前创建。测试的时候会自动创建和销毁的
            'NAME':'随便起一个名字'
        }
    }
}
</code></pre>
<p><strong>引入APP</strong></p>
<pre><code>INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
		#这里直接引入你创建的名字，有两种写法都行
		#直接引入你创建的app的名字
		# 'student'  
		#引入你你创建的app目录下的apps.py的自动创建的app类名 （这种写法更灵活，可以给app起别名等）
    'student.apps.StudentConfig',
]
</code></pre>
<p><strong>资源文件这里简单的配置下以作参考你完全可以自定路径，部署的时候再考虑这个问题更好</strong></p>
<pre><code>STATIC_URL = '/static/'
STATIC_ROOT = os.path.join(BASE_DIR,'static')
</code></pre>
<p><strong>如何区分生产环境和测试环境</strong>
以上这样基本的框架配置完成后,你可以试着运行没有一点问题，实际上我们在开发过程中，经常会碰到这样的问题，开发环境和测试环境有很多配置是不一样，我们当然也可以继续在settings.py自己修改，但是你会想，有没有更好的解决方案能不能搞两套设置文件，一套测试环境使用，一套生产环境使用
自己观察下manager.py这个文件会发现这句代码</p>
<pre><code>#导入django的配置文件
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'studentManager.settings')
</code></pre>
<p>我们把settings.py删除 记着保存一份新建一个python package，命名为settings
新建3个python文件如下图<br>
<img src="https://jackwuhao.github.io/post-images/1574491111080.png" alt=""></p>
<p>把原先settings.py里面的配置全部复制到base.py
在develop.py  和 product.py 分入加入这句代码</p>
<pre><code>#引入base.py的所有配置
from .base import * 
</code></pre>
<p>如果你想修改某个配置的直接重写就行了
如product.py</p>
<pre><code>#关闭测试环境
DEBUG = False
ALLOWED_HOSTS = ['*']
</code></pre>
<p><strong>修改manage.py 和wsgi.py的配置设置</strong><br>
把这句代码</p>
<pre><code>os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'studentManager.settings')
</code></pre>
<p>替换为</p>
<pre><code>#正式环境（生产环境）
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'studentManager.settings.product') 
# 测试环境
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'studentManager.settings.develop')
</code></pre>
<p>这样就把我们的测试环境和生产环境的配置完全区分开了</p>
<p><strong>最后上传github</strong><br>
1.修改下配置，在settiings包下，新建base_example.py 把里面你的key 和mysql，等其他重要的配置替换 (如何在develop.py 和product.py有重要配置记着同样替换掉)
2. 创建requirements.txt文件</p>
<pre><code>#在项目目录下生成项目的依赖文件
pip freeze &gt; ./requirements.txt
</code></pre>
<p>别人使用时</p>
<pre><code>#安装依赖
pip install -r requirements.txt
</code></pre>
<p>3 创建.gitignore文件</p>
<pre><code>mkdir  .gitignore
</code></pre>
<p>在.gitignore文件里写入下面的忽略内容(在develop.py 和product.py有重要配置记着同样忽略掉)：</p>
<pre><code>.gitignore
venv
.idea
db.sqlite3
studentManager/__pycache__/
settings/base.py
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[狄克斯拉算法]]></title>
        <id>https://jackwuhao.github.io/post/di-ke-si-la-suan-fa</id>
        <link href="https://jackwuhao.github.io/post/di-ke-si-la-suan-fa">
        </link>
        <updated>2019-11-21T11:56:42.000Z</updated>
        <content type="html"><![CDATA[<h1 id="逻辑分析">逻辑分析：</h1>
<p>1: 找出最便宜的的节点,可在短时间内前往的节点
2: 对于该节点的邻居检查是否有其他节点，如果有就更新开销
3：重复这个过程直到对图中的所有节点都这样做
4：计算最终路径</p>
<h1 id="用于解决的问题">用于解决的问题</h1>
<p>1.从A出发是否存在到达B的路径；
2.从A出发到达B的最短路径(时间最少、或者路径最少等)，事实上最后计算完成后，已经得到了A到各个节点的最短路径了；</p>
<pre><code>#把所有的节点的邻居都存储在grash里面
graph = {}
graph[&quot;Start&quot;] = {}
graph[&quot;Start&quot;][&quot;A&quot;] = 6
graph[&quot;Start&quot;][&quot;B&quot;] = 2
graph[&quot;A&quot;] = {}
graph[&quot;A&quot;][&quot;End&quot;] = 4
graph[&quot;B&quot;] = {}
graph[&quot;B&quot;][&quot;C&quot;] = 1
graph[&quot;B&quot;][&quot;End&quot;] = 7
graph[&quot;C&quot;] = {}
graph[&quot;C&quot;][&quot;A&quot;] = 4
graph[&quot;C&quot;][&quot;End&quot;] = 5

#infinity代表无穷大（或者未知）
infinity = float(&quot;inf&quot;)
#costs 代表所有的权重
costs = {}
costs[&quot;A&quot;] = 6
costs[&quot;B&quot;] = 2
costs[&quot;C&quot;] = infinity
costs[&quot;End&quot;] = infinity
#用来存储父节点
parents = {}
parents[&quot;A&quot;] = &quot;Start&quot;
parents[&quot;B&quot;] = &quot;Start&quot;
parents[&quot;C&quot;] = None
parents[&quot;End&quot;] = None

#用来记录处理过的节点
processed = []

#在未处理的节点里面找出开销最小的节点
def findLowestCostNode(costs, processed):
    lowest_cost = infinity
    lowest_cost_node = None
    for node in costs.keys():
        cost = costs[node]
        if  cost &lt; lowest_cost and node not in processed: #每次找到最小的并且并不存在在poressed里面
            lowest_cost = cost
            lowest_cost_node = node
    return lowest_cost_node
		
def  getResult():
       node = findLowestCostNode(costs, processed) #节点
       while node is not None and node != &quot;End&quot;:
        cost = costs[node] # 获取开销
        print(node)
        neighbors = graph[node]
        for n in neighbors.keys():
            new_cost = cost + neighbors[n]
            if new_cost &lt; costs[n]:
                costs[n] = new_cost
                parents[n] = node

        processed.append(node)
        node = findLowestCostNode(costs, processed)
   
if __name__ == '__main__':
      getResult()
      print(costs)
      print(parents)




</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[git 自动化 post-receive用法（服务器自动化部署的原理）建议先看post-commit的用法]]></title>
        <id>https://jackwuhao.github.io/post/git-zi-dong-hua-post-receive-yong-fa-fu-wu-qi-zi-dong-hua-bu-shu-de-yuan-li</id>
        <link href="https://jackwuhao.github.io/post/git-zi-dong-hua-post-receive-yong-fa-fu-wu-qi-zi-dong-hua-bu-shu-de-yuan-li">
        </link>
        <updated>2019-11-19T13:34:57.000Z</updated>
        <content type="html"><![CDATA[<p>post-receive 的用法比post-commit用法复杂点
基础知识：git基础  linux基础命令   git remote .git init的用法 ,git远程和本地仓库的区别和联系 ssh连接
非必须知识： 你嫌弃github慢的话你也可以自己集成gitlab或者gitweb
需要的工具：一台安装了git的linux服务器，一台安装了git的电脑
上面的内容请自己goole 或 百度
1.远程连接自己的linux服务器打开终端
一般不直接在root用户下添加.（root的权限太高了，为了服务器的安全）
1.添加git用户:</p>
<pre><code>     //添加用户git  （输密码的时候记着在其他地方记录下别忘记了）
    adduser git 

    //我这里把密码设置为git了
    passwd git 
</code></pre>
<ol start="2">
<li>把用户添加到用户组</li>
</ol>
<pre><code>	//一:切换到root用户下 
   su root  
	 //二：添加sudo文件的写权限 (记得w后面有空格)
	 chmod u+w  /etc/sudoers
	 // 第三步：编辑sudoers文件 
       vi  /etc/sudoers
   找到这行 root ALL=(ALL) ALL,在他下面添加xxx ALL=(ALL) ALL (这里的xxx是你的用户名) 
	 治理添加
	 git    ALL=(ALL) ALL 
	 //四:撤销sudoers文件写权限
	 chmod u-w  /etc/sudoers
</code></pre>
<p>2 .创建完成后</p>
<pre><code>//切换为git用户
su git 
//创建 存储你代码的文件 /data/wwwroot/testDeploy/test目录
  sudo mkdir -p  /data/wwwroot/testDeploy/test
</code></pre>
<p>3.初始化裸仓库</p>
<pre><code>cd  /home/git
 sudo git  init --bare test.git
</code></pre>
<p>4.git授权</p>
<pre><code>sudo chown -R git lara.git
</code></pre>
<p>5 cd到 你刚才创建的/data/wwwroot/testDeploy/test目录下创建本地仓库</p>
<pre><code>cd   /data/wwwroot/testDeploy/test
//（其实就是配置本地git仓库）后面追加的路径是 你刚刚创建的远程仓库路径
git clone  /home/git/test.git 
</code></pre>
<ol start="6">
<li>配置hooks</li>
</ol>
<pre><code>cd /home/git/test.git/hooks/
sudo vim post-receive 
</code></pre>
<p>这里贴一个shell脚本示例，具体的用法自己根据自己的实际情况自己添加</p>
<pre><code>#!/bin/sh

#判断是不是远端仓库（如果不是退出）
IS_BARE=$(git rev-parse --is-bare-repository)
if [ -z &quot;$IS_BARE&quot; ]; then
echo &gt;&amp;2 &quot;fatal: post-receive: IS_NOT_BARE&quot;
exit 1
fi
unset GIT_DIR
DeployPath=&quot;/data/wwwroot/testDeploy/test&quot;

echo &quot;==============================================

cd $DeployPath
echo &quot;deploying the test &quot;

echo &quot;git&quot;| sudo -S git fetch --all
echo &quot;git&quot;| sudo -S git reset --hard origin/master

time=`date`
echo &quot;数据刷新成功at time: $time.&quot;
echo &quot;================================================&quot;
</code></pre>
<p>7 .执行shell脚本</p>
<pre><code>sudo chmod +x  post-receive
</code></pre>
<p>测试一下脚本是否有问题</p>
<pre><code>sudo ./post-receive
</code></pre>
<p>这样服务端就搞定了剩下客户端的了</p>
<p>随便新起一个目录如test</p>
<pre><code> cd  test
// git clone :clone命令
// git :表示的是服务器用户(如果你没配的话这里是root）
//xxxx.xxx.x.xx: 表示你服务器的IP地址
// /home/git/test.git :表示你上面创建的远程仓库路径
git clone git@xxxx.xxx.x.xx:/home/git/test.git
//随便修改点东西
git add .
git commit -m&quot;test&quot;
git push 
</code></pre>
<p>这是登录你的服务器到  /data/wwwroot/testDeploy/test 查看 会发现你修改的同步到这里了，
以上就是 post-receive，用来做服务器自动化部署的原理</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[git的自动化  post-commit用法]]></title>
        <id>https://jackwuhao.github.io/post/git-de-zi-dong-hua-post-commit-yong-fa-qin-ce-ke-xing</id>
        <link href="https://jackwuhao.github.io/post/git-de-zi-dong-hua-post-commit-yong-fa-qin-ce-ke-xing">
        </link>
        <updated>2019-11-19T12:42:53.000Z</updated>
        <content type="html"><![CDATA[<p>1.自行了解git基础 不懂得可以看下<a href="https://www.liaoxuefeng.com/wiki/896043488029600">廖雪峰大神的git教程</a><br>
2.  post-commit用法
1. github上创建一个项目本地clone 下
2. 随便修改点东西 如修改readme.md (就是测试commit能否成功)</p>
<pre><code>     git add .
     git commit -m&quot;提交代码&quot;
     git push origin master
</code></pre>
<ol start="3">
<li>命令ls -a 可得：
<img src="https://jackwuhao.github.io/post-images/1574167906789.png" alt=""><br>
可以看到有一个.git的隐藏目录</li>
</ol>
<pre><code>      cd  .git
      cd hooks
</code></pre>
<ol start="4">
<li>可以看到下图<br>
<img src="https://jackwuhao.github.io/post-images/1574168210251.png" alt=""></li>
</ol>
<p>5.在hooks/目录下</p>
<pre><code> //	创建文件(命名不能错)
   touch  post-commit 
	 vim post-commit 
</code></pre>
<p>复制如下代码:(我这里用的Python 也可以直接写 入你自己的脚本命名)</p>
<pre><code>#! /bin/sh
# 因为你执行git commit的时候和.git在同一目录所以需要添加上路径否者找不到post-commit.py文件 我这里用的是python3（python2.7明年就过期了老铁们赶紧升级吧）
python3  .git/hooks/post-commit.py
</code></pre>
<p>这里贴下常见的发邮件的脚本post-commit.py （最好在pycharm编写然后复制）</p>
<pre><code># -*- coding: utf-8 -*-
import smtplib
from email.mime.text import MIMEText
from email.header import Header
from subprocess import check_output

#使用QQ邮箱做测试，填写QQ的smtp服务器名称
mail_host = &quot;smtp.qq.com&quot;
#替换成自己使用的QQ邮箱
mail_user = &quot;xxxxx@qq.com&quot;
#替换成自己使用的授权码(非自己的QQ密码)授权码详见:http://service.mail.qq.com/cgi-bin/help?subtype=1&amp;&amp;id=28&amp;&amp;no=1001256
mail_pass = &quot;xxxxx&quot;
#使用Python中的subprocess的check_output函数来捕获运行了git命令后的标准输出
#获取执行一条commit 信息并log出来所以参数如下
log = check_output(['git', 'log', '-1', '-p']).decode()

m = log.split('\n',5)[4]
#分割字符串得到最后的一个参数 email
arg = m.split(' ')[-1]
if arg[:6] == 'email:':
    receiver = arg[6:]
    print(receiver)
    sender = mail_user
    receivers = [receiver]

    message = MIMEText(log)
    message['From'] = Header(mail_user, 'utf-8')
    message['To'] =  Header(str(receivers), 'utf-8')

    subject = 'This is a commit log for you!'
    message['Subject'] = Header(subject, 'utf-8')

    try:
        smtpObj = smtplib.SMTP_SSL(mail_host, 465)
        smtpObj.login(mail_user,mail_pass)
        smtpObj.sendmail(sender, receivers, message.as_string())
        smtpObj.quit()
        print (&quot;Send the diff email to:&quot;, receiver)
    except smtplib.SMTPException as e:
        print (e)
</code></pre>
<p>这是需要执行下否者会你commit的时候会提示命令无法执行被忽略</p>
<pre><code>//执行shell脚本(只有post-commit是shell脚本 post-commit.py是python文件 执行shell脚本的命令是运行python脚本)
chmod  +x  post-commit 
</code></pre>
<p>当然你也可以测试下脚本是否有错
这里你可以修改下
post-commit.py 的内容为：</p>
<pre><code># -*- coding: utf-8 -*-
print(&quot;aaaa&quot;)
</code></pre>
<p>运行 ./post-commit  是否会打印 aaaa ,如果打印aaaa表明脚本执行成功,记得改回post-commit.py的代码</p>
<p>返回到你clone的文件加下，我这里是在testGitHook/下
<img src="https://jackwuhao.github.io/post-images/1574170064934.png" alt=""></p>
<p>随便修改下readme.md内容</p>
<pre><code>   git add .
  	 //上面的代码是以emial:为切割的起始位置的所以需要在后面加上email:你的邮箱地址
   git commit -m&quot;提交代码 email:xxxx@qq.com&quot;
   这是会提示
  	 //同时也会通过你的QQ邮箱发一封邮件给你填下的邮箱地址
  	  Send the diff email to:你的邮箱地址
   ```















   
  
  



  	 
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[SWIFTUI]]></title>
        <id>https://jackwuhao.github.io/post/swiftui</id>
        <link href="https://jackwuhao.github.io/post/swiftui">
        </link>
        <updated>2019-11-19T03:26:59.000Z</updated>
        <content type="html"><![CDATA[<p>swiftUI ,距离实际运用还差的很多，如果之前用过flutter，会感觉很相似，一个一切皆widget,一个一皆view
都是通过对不同的组件进行组装进行开发
<a href="https://developer.apple.com/tutorials/swiftui">swift组件介绍</a>
<a href="https://github.com/JackWuHao/swiftUI.git">demo</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[修改http请求为https]]></title>
        <id>https://jackwuhao.github.io/post/xiu-gai-http-qing-qiu-wei-https</id>
        <link href="https://jackwuhao.github.io/post/xiu-gai-http-qing-qiu-wei-https">
        </link>
        <updated>2019-11-16T02:52:23.000Z</updated>
        <content type="html"><![CDATA[<p>https://certbot.eff.org     选择系统和软件完后直接安装就行了，安装的时候注意下英文提示。看不懂的请翻译</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[cocoapods  记一次重装]]></title>
        <id>https://jackwuhao.github.io/post/cocoapods-ji-yi-ci-chong-zhuang</id>
        <link href="https://jackwuhao.github.io/post/cocoapods-ji-yi-ci-chong-zhuang">
        </link>
        <updated>2019-11-11T13:27:38.000Z</updated>
        <content type="html"><![CDATA[<p><a href="https://www.jianshu.com/p/ab6411a05bc2">安装教程</a>
注意下macos 版本<br>
OS X 10.11之前系统的安装cocoapods 指令：$ sudo gem install cocoapods</p>
<p>OS X 10.11以后系统的安装cocoapods 指令：$ sudo gem install -n /usr/local/bin cocoa pods</p>
<p>cocoapods  现在默认是trun模式不习惯的可以通过新增source 回退到原先的模式</p>
<pre><code>platform :ios, '9.0'
# 取消trun 模式
source 'https://github.com/CocoaPods/Specs.git'


target 'TestSwiftUI' do
   use_frameworks!
    # 忽略引入库的所有警告
   inhibit_all_warnings!
   # 布局相当于masony
   pod 'SnapKit'
   #图片的下载和缓存
   pod 'Kingfisher'
   #banner滚动图片
   pod 'FSPagerView'
   #网络请求库
   pod 'Moya'
end
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[换了个服务器引发的血案   记 django 运维]]></title>
        <id>https://jackwuhao.github.io/post/huan-liao-ge-fu-wu-qi-yin-fa-de-xie-an-ji-django-yun-wei</id>
        <link href="https://jackwuhao.github.io/post/huan-liao-ge-fu-wu-qi-yin-fa-de-xie-an-ji-django-yun-wei">
        </link>
        <updated>2019-11-11T08:40:25.000Z</updated>
        <content type="html"><![CDATA[<p>经过一番努力成功:<a href="http://xiaocaoaixuexi.club/login/">个人网站</a></p>
<p>说说经历的坑吧
一 : 之前是python2 搭建的  ，由于2020年python2就过期了，为了以后不麻烦重新基于python3搭建，现在服务器大部分的默认的python2.7和3.5
1.升级Python版本:</p>
<pre><code>sudo add-apt-repository ppa:jonathonf/python-3.6   //添加3.6版本
sudo apt-get update  //升级系统
sudo apt-get install python3.6  //install python3.6版本
</code></pre>
<p>2.由于默认调用的python2.7 需要改一下版本优先级</p>
<pre><code>sudo update-alternatives --install /usr/bin/python3 python3 /usr/bin/python3.6 2  //()调整Python3的优先级，使得3.6优先级较高 
//修改默认python的版本
sudo update-alternatives --install /usr/bin/python python /usr/bin/python2 100
sudo update-alternatives --install /usr/bin/python python /usr/bin/python3 150
</code></pre>
<p><img src="https://jackwuhao.github.io/post-images/1573464138701.png" alt="">
3 .安装nginx</p>
<pre><code>sudo apt update
sudo apt install nginx
</code></pre>
<p>nginx 常用命令</p>
<pre><code>//检查Nginx服务的状态和版本
sudo systemctl status nginx     
//查看nginx的版本
sudo nginx -v
//停止止Nginx服务
sudo systemctl stop nginx
//启动
sudo systemctl start nginx
//重新启动
sudo systemctl restart nginx
//在进行一些配置更改后重新加载Nginx服务
sudo systemctl reload nginx
//禁用Nginx服务在启动时启动
sudo systemctl disable nginx
//重新启用
sudo systemctl enable nginx
//查看nginx的.conf文件的位置
sudo nginx -t
</code></pre>
<p>4 安装虚拟环境（不要也行）</p>
<pre><code>#放虚拟环境的
sudo mkdir -p /data/env

#放项目的
sudo mkdir -p /data/wwwroot
sudo pip3 install virtualenv
cd  /data/env
sudo virtualenv -p /usr/bin/python3 pyweb
启动虚拟环境
source /data/env/pyweb/bin/activate
退出虚拟环境
deactivate 
</code></pre>
<p>5 上传项目 推荐git</p>
<pre><code>//查看git版本  如果没有的会提示你安装
git -v  
</code></pre>
<p>安装git</p>
<pre><code>sudo apt-get install git 
git -v  
</code></pre>
<p>对git 不熟悉的话,请到廖雪峰老师的博客学习一遍
配置项目的环境为生产环境（改配置的时候仔细点）
cd  /data/wwwroot/你的项目</p>
<pre><code>//安装配置文件
sudo pip3 install -r requirements.txt   
//8000 端口要释放 测试项目是否能够启动
python3 manage.py runserver 0.0.0.0:8000  
</code></pre>
<p>如果没错的话，访问http://&lt;你的服务器ip&gt;:8000/，不出意外的话你会看到你项目的页面展示，这是是缺少css等文件的，不用急
6 安装uwsign</p>
<pre><code>sudo pip3 install uwsgi  
</code></pre>
<p>测试uwsgi</p>
<pre><code>//随便新建一个.py文件这里新建一个hello.py
def application(env,start_response):
    start_response('200 OK',[('Content-Type','text/html')])
    return [b&quot;Hello world&quot;]
</code></pre>
<p>在当前目录下（记着开放端口）</p>
<pre><code>uwsgi --http :8000 --wsgi-file hello.py
</code></pre>
<p>关于端口号被占用：</p>
<pre><code>//按端口号查询
lsof -i :8002
//按程序名称查询
ps aux | grep uwsgi
//释放端口号:根据 PID 可以用下面的命令 kill 掉相关程序
sudo kill -9 2208 2209

</code></pre>
<p>找个浏览器，访问http://&lt;你的服务器ip&gt;:8000/，不出意外的话你会看到Hello world的，说明uwsgi能正常运行。</p>
<pre><code>control c  //取消当前进程
</code></pre>
<p>回到项目的根目录 /data/wwwroot/&lt;你的project名字&gt; 新建一个mysite.xml（名字随意其实就是一个配置文件）填写配置，这里来个以.xml配置举例 （其他如.ini 都大同小异）</p>
<pre><code>&lt;uwsgi&gt;    
   &lt;socket&gt;127.0.0.1:8000&lt;/socket&gt;&lt;!-- 内部端口自定义 即Python manager.py runserver 8000 --&gt; 
   &lt;chdir&gt;/data/wwwroot/&lt;你的project名字&gt;/&lt;/chdir&gt;&lt;!-- 项目的绝对路径路径 --&gt;            
   &lt;module&gt;你的app的名字.wsgi&lt;/module&gt;  &lt;！--django项目里面你的app下面的wsgi文件，这里填下相对路径，前面的项目路径都是绝对路径了或者 你的app/你的app的名字.wsgi ; 即你的app的名字.wsgi =你的app/你的.wsgi 文件名字，（这里实际路径就是:项目的绝对路径路径/你的app/你的.wsgi 文件名字）--&gt;
   &lt;processes&gt;4&lt;/processes&gt; &lt;!-- 进程数 --&gt;     
   &lt;daemonize&gt;uwsgi.log&lt;/daemonize&gt;&lt;!-- 日志文件 --&gt;
&lt;/uwsgi&gt;
</code></pre>
<p>执行uwsgi 命令</p>
<pre><code>uwsgi -x mysite.xml
		 
</code></pre>
<p>出错的话请查看uwsgi.log ，自行goole或者百度<br>
7. 配置nginx
获取nginx.conf</p>
<pre><code>		 //获取配置文件的位置
nginx -t   
		 
</code></pre>
<p>一般默认在/etc/nginx/nginx.conf
<a href="https://www.jianshu.com/p/849343f679aa"> nginx 的详细配置</a><br>
//这里贴个示例</p>
<pre><code>events {
    worker_connections  1024;
}
http {
    include       mime.types;
    default_type  application/octet-stream;
    sendfile        on;
    server {
        listen       80;
        server_name  www.django.cn;
        charset utf-8;
        location / {
           include uwsgi_params;
		      # 要和你uwsgi的配置文件mysite.xml配置一致
           uwsgi_pass 127.0.0.1:8000;
           uwsgi_param UWSGI_SCRIPT  你的app的名字.wsgi; # 上面都解释的很清楚了
           uwsgi_param UWSGI_CHDIR  /data/wwwroot/&lt;你的project名字&gt;/; #项目路径
           
        }
        location /static/ {
        alias /data/wwwroot/mysite/static/; #静态资源路径
        }
    }
}
		 
</code></pre>
<p>完成后</p>
<pre><code>sudo systemctl status nginx  
//没启动的启动，启动的reload ,上面都解释过了
sudo systemctl reload nginx		 
</code></pre>
<p>随便打开个浏览器测试 搞定！</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[持续学习 每日一更 springboot]]></title>
        <id>https://jackwuhao.github.io/post/chi-xu-xue-xi-mei-ri-yi-geng-springboot</id>
        <link href="https://jackwuhao.github.io/post/chi-xu-xue-xi-mei-ri-yi-geng-springboot">
        </link>
        <updated>2019-11-05T11:57:49.000Z</updated>
        <content type="html"><![CDATA[<p>ps:学习java是真的费劲,估计最少的一个月才能入门，还是我大python 爽呀学习成本基本没有搞起来贼快
想念django的第一天
<a href="https://github.com/JackWuHao/SpringBootTest.git">下载地址</a></p>
]]></content>
    </entry>
</feed>